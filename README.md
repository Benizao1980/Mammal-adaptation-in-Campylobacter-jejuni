<p align="center">
  <img src="panopticon_logo_variant2_partial.svg" width="360" alt="PANOPTICON logo">
</p>

# PANOPTICON

*Exploratory analysis of population structure and ecological signal in bacterial pangenomes.*

PANOPTICON is a toolbox for looking carefully at pangenome data **before** jumping to
formal inference or machine-learning models.

The motivation is simple: in bacterial genomics, many apparent signals — host association,
geography, phenotype — are shaped or confounded by **population structure, recombination,
and lineage effects**. If those patterns aren’t understood first, downstream analyses can
be difficult to interpret or, worse, misleading.

PANOPTICON exists to make those patterns visible.

---

## Where this fits

PANOPTICON is the **foundation layer** of a connected analytical programme:

- **PANOPTICON** explores population structure, gene content, and ecological signal
- **SourceRunnerML** builds on that structure to perform source attribution
- **BAMPS-ML** applies the same philosophy to antimicrobial resistance phenotypes

In practice, PANOPTICON is where hypotheses are generated, stress-tested, and refined
before being formalised elsewhere.

---

## What PANOPTICON is (and isn’t)

PANOPTICON is **not** a pangenome construction pipeline. It assumes that gene
presence/absence matrices already exist (e.g. from PIRATE or Panaroo).

What it provides instead is a set of **modular, script-based analyses** for asking
questions such as:

- How strongly structured is this population?
- Are observed differences driven by host ecology or lineage?
- Which signals persist after accounting for population structure?
- Where does variability sit: between lineages, within lineages, or across environments?

The emphasis is on **exploration and interpretation**, not automation.

---

## Core functionality

PANOPTICON supports:

- ordination and visualisation of gene presence/absence data
- multivariate testing (e.g. PERMANOVA and related approaches)
- lineage-aware and stratified comparisons
- integration of metadata (host, geography, phenotype, source)
- exploratory summaries designed to inform downstream modelling

Analyses are intentionally **composable** rather than wrapped in a single black-box
workflow. This reflects the reality that different datasets often require different
questions to be asked.

---

## Design philosophy

PANOPTICON treats the pangenome as a **population-genetic object**, not just a feature
matrix.

Key principles are:
- population structure should be characterised, not ignored
- lineage effects should be examined explicitly
- apparent associations should be interrogated, not assumed
- visualisation and statistics should support interpretation, not replace it

This philosophy carries through directly into SourceRunnerML and BAMPS-ML.

---

## Typical use cases

PANOPTICON is most useful when you want to:

- explore pangenome structure prior to machine learning
- understand drivers of host or ecological association
- contextualise GWAS or ML results
- decide whether a signal is likely to generalise beyond a single lineage

It is deliberately conservative, and often points out when a dataset is **not yet ready**
for stronger claims.

---

## Input data

PANOPTICON operates on gene presence/absence matrices generated by external tools such as:

- **PIRATE**
- **Panaroo**

These are combined with metadata tables describing isolates (e.g. host, source,
geography, phenotype).

Exact input formats and example workflows are provided in the repository documentation.

---

## Relationship to downstream tools

Insights from PANOPTICON typically inform:

- feature selection and interpretation in **SourceRunnerML**
- understanding lineage effects in **BAMPS-ML**
- framing results sections and figures in manuscripts

In this sense, PANOPTICON often shapes the *questions* before models are ever trained.

---

## Documentation and citation

Individual scripts and example workflows are documented in the repository.

If you use PANOPTICON in academic work, please cite the associated manuscript(s) and
acknowledge the upstream pangenome tools used to generate input data.
